}
}
b1e=fixpt_b1(b1g,1e-10,10000)
a1e=alpha1(b1e)
b2e=fixpt_b2(b2g,1e-10,10000)
a2e=alpha2(b2e)
re=rhoo(b1e,b2e)
##yaha tak code sahi hai copy paste of my last program b1e,b2e,1e,a2e,re are mle
term1=-n*log(a1c)-n*log(a2e)-n*log(b1e)-n*log(b2e)-(n/2)*log(1-(re^2))-n*log(4)-n*log(2*pi)
un=(1/a1c)*(sqrt(t1/b1e)-sqrt(b1e/t1))
vn=(1/a2e)*(sqrt(t2/b2e)-sqrt(b2e/t2))
term2=sum(log((b1e/t1)^(1/2)+(b1e/t1)^(3/2)))+sum(log((b2e/t2)^(1/2)+(b2e/t2)^(3/2)))
term3=(1/(2*(1-re^2)))*(sum((un^2)+(vn^2)-2*re*(un*vn)))
lbvbs=term1+term2-term3
##lbvbs is loglikelihood
return(lbvbs)
}
a1k=seq(from=0.01,to=10,by=0.01)
plot(a1k,lik(a1k),type="l")
rm(list=ls())
lik=function(a1c){
##simulating from BVBS(a1,a2,b1,b2,rho)
n=20
u1=rnorm(n,0,1);u2=rnorm(n,0,1)
rho=0.5
d1=sqrt(1+rho)+sqrt(1-rho)
d2=sqrt(1+rho)-sqrt(1-rho)
z1=(d1/2)*u1+(d2/2)*u2
z2=(d1/2)*u2+(d2/2)*u1
b1=2;b2=2
a1=0.2;a2=2
x1=(a1*z1)/2; x2=(a2*z2)/2
##t1 and t2 follows bvbs
t1=b1*((x1+sqrt((x1^2)+1))^2)
t2=b2*((x2+sqrt((x2^2)+1))^2)
##modified moment as initial guess
s1=mean(t1);s2=mean(t2)
r1=((1/n)*sum(1/t1))^-1;r2=((1/n)*sum(1/t2))^-1
alpha1=function(beta1){
return(((s1/beta1)+(beta1/r1)-2)^(1/2))
}
alpha2=function(beta2){
return(((s2/beta2)+(beta2/r2)-2)^(1/2))
}
rhoo=function(beta1,beta2){
sum((sqrt(t1/beta1)-sqrt(beta1/t1))*(sqrt(t2/beta2)-sqrt(beta2/t2)))/((sqrt(sum((sqrt(t1/beta1)-sqrt(beta1/t1))^2)))*(sqrt(sum((sqrt(t2/beta2)-sqrt(beta2/t2))^2))))
}
a1g=(2*(((s1/r1)^(1/2))-1))^(1/2);a2g=(2*(((s2/r2)^(1/2))-1))^(1/2)
b1g=(s1*r1)^(1/2);b2g=(s2*r2)^(1/2)
rhoog=sum((sqrt(t1/b1g)-sqrt(b1g/t1))*(sqrt(t2/b2g)-sqrt(b2g/t2)))/((sqrt(sum((sqrt(t1/b1g)-sqrt(b1g/t1))^2)))*(sqrt(sum((sqrt(t2/b2g)-sqrt(b2g/t2))^2))))
k1=function(x){
return( ((1/n)*sum((x+t1)^-1))^(-1))
}
k2=function(x){
return( ((1/n)*sum((x+t2)^-1))^(-1))
}
h_b1=function(b1g){
return((r1*(s1+k1(b1g)))/(2*r1+k1(b1g)-b1g))
}
fixpt_b1 <- function(x0, tol = 1e-10, max.iter = 100000) {
b1_old=x0
b1_new=h_b1(b1_old)
iter=1
while ((abs(b1_new-b1_old) > tol) && (iter < max.iter)) {
b1_old <- b1_new;
b1_new <- h_b1(b1_old);
iter <- iter + 1
}
if (abs(b1_new-b1_old) > tol) {
return(NULL)
} else {
return(b1_new)
}
}
h_b2=function(b2g){
return((r2*(s2+k2(b2g)))/(2*r2+k2(b2g)-b2g))
}
fixpt_b2 <- function(x0, tol = 1e-10, max.iter = 100000) {
b1_old=x0
b1_new=h_b2(b1_old)
iter=1
while ((abs(b1_new-b1_old) > tol) && (iter < max.iter)) {
b1_old <- b1_new;
b1_new <- h_b2(b1_old);
iter <- iter + 1
}
if (abs(b1_new-b1_old) > tol) {
return(NULL)
} else {
return(b1_new)
}
}
b1e=fixpt_b1(b1g,1e-10,10000)
a1e=alpha1(b1e)
b2e=fixpt_b2(b2g,1e-10,10000)
a2e=alpha2(b2e)
re=rhoo(b1e,b2e)
##yaha tak code sahi hai copy paste of my last program b1e,b2e,1e,a2e,re are mle
term1=-n*log(a1c)-n*log(a2e)-n*log(b1e)-n*log(b2e)-(n/2)*log(1-(re^2))-n*log(4)-n*log(2*pi)
un=(1/a1c)*(sqrt(t1/b1e)-sqrt(b1e/t1))
vn=(1/a2e)*(sqrt(t2/b2e)-sqrt(b2e/t2))
term2=sum(log((b1e/t1)^(1/2)+(b1e/t1)^(3/2)))+sum(log((b2e/t2)^(1/2)+(b2e/t2)^(3/2)))
term3=(1/(2*(1-re^2)))*(sum((un^2)+(vn^2)-2*re*(un*vn)))
lbvbs=term1+term2-term3
##lbvbs is loglikelihood
return(lbvbs)
}
a1k=seq(from=0.01,to=10,by=0.01)
plot(a1k,lik(a1k),type="l")
lik(a1k)
plot(sampl_size_log10,leng_ebs[2,],type="l",ylim=c(20,2500),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[2,],col="green")
rm(list=ls())
setwd("C:/Users/Hp/Documents/GitHub/Batch_Means_Online/check_value_constant")
source("ibs_lng.R")
source("ebs_lng.R")
alp <- .51
cns_sq <- c(0.01,0.1,1,2,5)
sq_n <- seq(1e4,1e6,by=5e3)
leng_ebs <- matrix(nrow=5,ncol=length(sq_n))
leng_ibs <- matrix(nrow=5,ncol=length(sq_n))
for( k in 1:length(sq_n)){
n <- sq_n[k]
for (m in 1 : length(cns_sq)){
leng_ebs[m,k] <- ebs_lng(n,cns=cns_sq[m],alp,bet_typ=1)
leng_ibs[m,k] <- ibs_lng(n,cns=cns_sq[m],alp)
}
}
sampl_size_log10 <- log10(sq_n)
plot(sampl_size_log10,leng_ebs[2,],type="l",ylim=c(20,2500),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[2,],col="green")
plot(sampl_size_log10,leng_ebs[2,],type="l",ylim=c(20,250),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[2,],col="green")
sampl_size_log10 <- log10(sq_n)
plot(sampl_size_log10,leng_ebs[1,],type="l",ylim=c(20,2500),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[1,],col="green")
plot(sampl_size_log10,leng_ebs[2,],type="l",ylim=c(20,250),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[2,],col="green")
plot(leng_ebs[3,],sampl_size_log10,type="l",ylim=c(2,6.5),xlab="Dimension",ylab="Sample size on log10 scale",main="c=1, beta type 1")
lines(leng_ebs[3,],log10(leng_ibs[3,]),col="green")
plot(sampl_size_log10,leng_ebs[2,],type="l",ylim=c(20,250),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[2,],col="green")
plot(sampl_size_log10,leng_ebs[3,],type="l",ylim=c(20,250),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[3,],col="green")
plot(sampl_size_log10,leng_ebs[3,],type="l",ylim=c(2,25),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[3,],col="green")
plot(sampl_size_log10,leng_ebs[3,],type="l",ylim=c(2,30),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[3,],col="green")
plot(sampl_size_log10,leng_ebs[3,],type="l",ylim=c(2,30),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[3,],col="green")
plot(sampl_size_log10,leng_ebs[4,],type="l",ylim=c(2,30),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[4,],col="green")
plot(sampl_size_log10,leng_ebs[4,],type="l",ylim=c(2,25),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[4,],col="green")
plot(sampl_size_log10,leng_ebs[4,],type="l",ylim=c(1,25),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[4,],col="green")
plot(sampl_size_log10,leng_ebs[4,],type="l",ylim=c(2,25),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[4,],col="green")
plot(sampl_size_log10,leng_ebs[5,],type="l",ylim=c(2,25),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[5,],col="green")
plot(sampl_size_log10,leng_ebs[5,],type="l",ylim=c(1,20),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[5,],col="green")
############################################################
#New setup for beta
sq_n <- seq(1e4,1e6,by=5e3)
leng_ebs <- matrix(nrow=5,ncol=length(sq_n))
leng_ibs <- matrix(nrow=5,ncol=length(sq_n))
for( k in 1:length(sq_n)){
n <- sq_n[k]
for (m in 1 : length(cns_sq)){
leng_ebs[m,k] <- ebs_lng(n,cns=cns_sq[m],alp,bet_typ=1)
leng_ibs[m,k] <- ibs_lng(n,cns=cns_sq[m],alp)
}
}
plot(leng_ebs[1,],sampl_size_log10,type="l",ylim=c(3,14),xlab="Dimension",ylab="Sample size on log10 scale",main="c=0.01, beta type 2")
rm(list=ls())
setwd("C:/Users/Hp/Documents/GitHub/Batch_Means_Online/check_value_constant")
source("ibs_lng.R")
source("ebs_lng.R")
alp <- .51
cns_sq <- c(0.01,0.1,1,2,5)
sq_n <- seq(1e4,1e6,by=5e3)
leng_ebs <- matrix(nrow=5,ncol=length(sq_n))
leng_ibs <- matrix(nrow=5,ncol=length(sq_n))
for( k in 1:length(sq_n)){
n <- sq_n[k]
for (m in 1 : length(cns_sq)){
leng_ebs[m,k] <- ebs_lng(n,cns=cns_sq[m],alp,bet_typ=1)
leng_ibs[m,k] <- ibs_lng(n,cns=cns_sq[m],alp)
}
}
plot(sampl_size_log10,leng_ebs[5,],type="l",ylim=c(1,20),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[5,],col="green")
rm(list=ls())
setwd("C:/Users/Hp/Documents/GitHub/Batch_Means_Online/check_value_constant")
source("ibs_lng.R")
source("ebs_lng.R")
alp <- .51
cns_sq <- c(0.01,0.1,1,2,5)
sq_n <- seq(1e4,1e6,by=5e3)
leng_ebs <- matrix(nrow=5,ncol=length(sq_n))
leng_ibs <- matrix(nrow=5,ncol=length(sq_n))
for( k in 1:length(sq_n)){
n <- sq_n[k]
for (m in 1 : length(cns_sq)){
leng_ebs[m,k] <- ebs_lng(n,cns=cns_sq[m],alp,bet_typ=1)
leng_ibs[m,k] <- ibs_lng(n,cns=cns_sq[m],alp)
}
}
sampl_size_log10 <- log10(sq_n)
pdf("zero_pt_01_beta_1.pdf")
plot(sampl_size_log10,leng_ebs[1,],type="l",ylim=c(20,2500),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[1,],col="green")
dev.off()
plot(sampl_size_log10,leng_ebs[2,],type="l",ylim=c(20,250),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[2,],col="green")
plot(sampl_size_log10,leng_ebs[3,],type="l",ylim=c(2,30),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[3,],col="green")
plot(sampl_size_log10,leng_ebs[4,],type="l",ylim=c(2,25),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[4,],col="green")
plot(sampl_size_log10,leng_ebs[5,],type="l",ylim=c(1,20),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[5,],col="green")
plot(sampl_size_log10,leng_ebs[1,],type="l",ylim=c(20,2500),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[1,],col="green")
legend(1, 95, legend=c("Line 1", "Line 2"),
col=c("red", "blue"), lty=1:2, cex=0.8)
legend(1, 10, legend=c("Line 1", "Line 2"),
col=c("red", "blue"), lty=1:2, cex=0.8)
dev.off()
plot(sampl_size_log10,leng_ebs[1,],type="l",ylim=c(20,2500),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[1,],col="green")
legend(1, 10, legend=c("Line 1", "Line 2"),
col=c("red", "blue"), lty=1:2, cex=0.8)
legend(10, 10, legend=c("Line 1", "Line 2"),
col=c("black", "green"), lty=c(1,1), cex=0.8)
plot(sampl_size_log10,leng_ebs[1,],type="l",ylim=c(20,2500),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[1,],col="green")
legend(10, 10, legend=c("Line 1", "Line 2"),
col=c("black", "green"), lty=c(1,1), cex=0.8)
plot(sampl_size_log10,leng_ebs[1,],type="l",ylim=c(20,2500),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[1,],col="green")
legend(10, 10, legend=c("Line 1", "Line 2"),
col=c("black", "green"), lty=c(1,1), cex=0.8)
rm(list=ls())
setwd("C:/Users/Hp/Documents/GitHub/Batch_Means_Online/check_value_constant")
source("ibs_lng.R")
source("ebs_lng.R")
alp <- .51
cns_sq <- c(0.01,0.1,1,2,5)
sq_n <- seq(1e4,1e6,by=5e3)
leng_ebs <- matrix(nrow=5,ncol=length(sq_n))
leng_ibs <- matrix(nrow=5,ncol=length(sq_n))
for( k in 1:length(sq_n)){
n <- sq_n[k]
for (m in 1 : length(cns_sq)){
leng_ebs[m,k] <- ebs_lng(n,cns=cns_sq[m],alp,bet_typ=1)
leng_ibs[m,k] <- ibs_lng(n,cns=cns_sq[m],alp)
}
}
sampl_size_log10 <- log10(sq_n)
plot(sampl_size_log10,leng_ebs[1,],type="l",ylim=c(20,2500),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[1,],col="green")
legend(10, 10, legend=c("Line 1", "Line 2"),
col=c("black", "green"), lty=c(1,1), cex=0.8)
legend( legend=c("Line 1", "Line 2"),
col=c("black", "green"), lty=c(1,1), cex=0.8)
legend( x="topright",legend=c("Line 1", "Line 2"),
col=c("black", "green"), lty=c(1,1), cex=0.8)
legend( x="topleft",legend=c("Line 1", "Line 2"),
col=c("black", "green"), lty=c(1,1), cex=0.8)
plot(sampl_size_log10,leng_ebs[1,],type="l",ylim=c(20,2500),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[1,],col="green")
legend( x="topleft",legend=c("Line 1", "Line 2"),
col=c("black", "green"), lty=c(1,1), cex=0.8)
############################################################
#New setup for beta
sq_n <- seq(1e4,1e6,by=5e3)
leng_ebs <- matrix(nrow=5,ncol=length(sq_n))
leng_ibs <- matrix(nrow=5,ncol=length(sq_n))
for( k in 1:length(sq_n)){
n <- sq_n[k]
for (m in 1 : length(cns_sq)){
leng_ebs[m,k] <- ebs_lng(n,cns=cns_sq[m],alp,bet_typ=2)
leng_ibs[m,k] <- ibs_lng(n,cns=cns_sq[m],alp)
}
}
sampl_size_log10 <- log10(sq_n)
plot(sampl_size_log10,leng_ebs[1,],type="l",ylim=c(20,2500),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[1,],col="green")
legend( x="topleft",legend=c("EBS", "IBS"),
col=c("black", "green"), lty=c(1,1), cex=0.8)
leng_ibs[1,
]
plot(sampl_size_log10,leng_ebs[1,],type="l",ylim=c(20,3500),xlab="Sample Size ",ylab="Number of batches")
plot(sampl_size_log10,leng_ebs[1,],type="l",ylim=c(20,5000),xlab="Sample Size ",ylab="Number of batches")
plot(sampl_size_log10,leng_ebs[1,],type="l",ylim=c(20,15000),xlab="Sample Size ",ylab="Number of batches")
plot(sampl_size_log10,leng_ebs[1,],type="l",ylim=c(20,8000),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[1,],col="green")
legend( x="topleft",legend=c("EBS", "IBS"),
col=c("black", "green"), lty=c(1,1), cex=0.8)
sq_n <- seq(1e4,1e6,by=5e3)
leng_ebs <- matrix(nrow=5,ncol=length(sq_n))
leng_ibs <- matrix(nrow=5,ncol=length(sq_n))
for( k in 1:length(sq_n)){
n <- sq_n[k]
for (m in 1 : length(cns_sq)){
leng_ebs[m,k] <- ebs_lng(n,cns=cns_sq[m],alp,bet_typ=2)
leng_ibs[m,k] <- ibs_lng(n,cns=cns_sq[m],alp)
}
}
sampl_size_log10 <- log10(sq_n)
plot(sampl_size_log10,leng_ebs[1,],type="l",ylim=c(20,8000),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[1,],col="green")
legend( x="topleft",legend=c("EBS", "IBS"),
col=c("black", "green"), lty=c(1,1), cex=0.8)
plot(sampl_size_log10,leng_ebs[2,],type="l",ylim=c(20,250),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[2,],col="green")
legend( x="topleft",legend=c("EBS", "IBS"),
col=c("black", "green"), lty=c(1,1), cex=0.8)
plot(sampl_size_log10,leng_ebs[2,],type="l",ylim=c(20,550),xlab="Sample Size ",ylab="Number of batches")
plot(sampl_size_log10,leng_ebs[2,],type="l",ylim=c(20,1550),xlab="Sample Size ",ylab="Number of batches")
plot(sampl_size_log10,leng_ebs[2,],type="l",ylim=c(20,1000),xlab="Sample Size ",ylab="Number of batches")
plot(sampl_size_log10,leng_ebs[2,],type="l",ylim=c(20,900),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[2,],col="green")
plot(sampl_size_log10,leng_ebs[3,],type="l",ylim=c(2,30),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[3,],col="green")
plot(sampl_size_log10,leng_ebs[3,],type="l",ylim=c(5,90),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[3,],col="green")
plot(sampl_size_log10,leng_ebs[3,],type="l",ylim=c(5,80),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[3,],col="green")
plot(sampl_size_log10,leng_ebs[4,],type="l",ylim=c(2,25),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[4,],col="green")
legend( x="topleft",legend=c("EBS", "IBS"),
col=c("black", "green"), lty=c(1,1), cex=0.8)
plot(sampl_size_log10,leng_ebs[4,],type="l",ylim=c(2,45),xlab="Sample Size ",ylab="Number of batches")
plot(sampl_size_log10,leng_ebs[4,],type="l",ylim=c(2,40),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[4,],col="green")
plot(sampl_size_log10,leng_ebs[5,],type="l",ylim=c(1,20),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[5,],col="green")
sq_n <- seq(1e3,1e6,by=5e3)
leng_ebs <- matrix(nrow=5,ncol=length(sq_n))
leng_ibs <- matrix(nrow=5,ncol=length(sq_n))
for( k in 1:length(sq_n)){
n <- sq_n[k]
for (m in 1 : length(cns_sq)){
leng_ebs[m,k] <- ebs_lng(n,cns=cns_sq[m],alp,bet_typ=3)
leng_ibs[m,k] <- ibs_lng(n,cns=cns_sq[m],alp)
}
}
sampl_size_log10 <- log10(sq_n)
plot(sampl_size_log10,leng_ebs[1,],type="l",ylim=c(20,2500),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[1,],col="green")
legend( x="topleft",legend=c("EBS", "IBS"),
col=c("black", "green"), lty=c(1,1), cex=0.8)
plot(sampl_size_log10,leng_ebs[1,],type="l",ylim=c(20,5500),xlab="Sample Size ",ylab="Number of batches")
plot(sampl_size_log10,leng_ebs[1,],type="l",ylim=c(20,9500),xlab="Sample Size ",ylab="Number of batches")
plot(sampl_size_log10,leng_ebs[1,],type="l",ylim=c(20,8500),xlab="Sample Size ",ylab="Number of batches")
plot(sampl_size_log10,leng_ebs[1,],type="l",ylim=c(20,8900),xlab="Sample Size ",ylab="Number of batches")
plot(sampl_size_log10,leng_ebs[1,],type="l",ylim=c(20,9000),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[1,],col="green")
plot(sampl_size_log10,leng_ebs[1,],type="l",ylim=c(2,9000),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[1,],col="green")
plot(sampl_size_log10,leng_ebs[2,],type="l",ylim=c(20,250),xlab="Sample Size ",ylab="Number of batches")
plot(sampl_size_log10,leng_ebs[2,],type="l",ylim=c(20,1050),xlab="Sample Size ",ylab="Number of batches")
plot(sampl_size_log10,leng_ebs[2,],type="l",ylim=c(20,950),xlab="Sample Size ",ylab="Number of batches")
plot(sampl_size_log10,leng_ebs[2,],type="l",ylim=c(20,1050),xlab="Sample Size ",ylab="Number of batches")
plot(sampl_size_log10,leng_ebs[2,],type="l",ylim=c(20,950),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[2,],col="green")
plot(sampl_size_log10,leng_ebs[3,],type="l",ylim=c(2,30),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[3,],col="green")
plot(sampl_size_log10,leng_ebs[3,],type="l",ylim=c(2,100),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[3,],col="green")
plot(sampl_size_log10,leng_ebs[4,],type="l",ylim=c(2,25),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[4,],col="green")
plot(sampl_size_log10,leng_ebs[4,],type="l",ylim=c(2,55),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[4,],col="green")
plot(sampl_size_log10,leng_ebs[4,],type="l",ylim=c(2,50),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[4,],col="green")
plot(sampl_size_log10,leng_ebs[5,],type="l",ylim=c(1,20),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[5,],col="green")
rm(list=ls())
setwd("C:/Users/Hp/Documents/GitHub/Batch_Means_Online/check_value_constant")
source("ibs_lng.R")
source("ebs_lng.R")
alp <- .51
cns_sq <- c(0.01,0.1,1,2,5)
sq_n <- seq(1e4,1e6,by=5e3)
leng_ebs <- matrix(nrow=5,ncol=length(sq_n))
leng_ibs <- matrix(nrow=5,ncol=length(sq_n))
for( k in 1:length(sq_n)){
n <- sq_n[k]
for (m in 1 : length(cns_sq)){
leng_ebs[m,k] <- ebs_lng(n,cns=cns_sq[m],alp,bet_typ=1)
leng_ibs[m,k] <- ibs_lng(n,cns=cns_sq[m],alp)
}
}
sampl_size_log10 <- log10(sq_n)
pdf("zero_pt_01_beta_1.pdf")
plot(sampl_size_log10,leng_ebs[1,],type="l",ylim=c(20,2500),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[1,],col="green")
legend( x="topleft",legend=c("EBS", "IBS"),
col=c("black", "green"), lty=c(1,1), cex=0.8)
dev.off()
pdf("zero_pt_1_beta_1.pdf")
plot(sampl_size_log10,leng_ebs[2,],type="l",ylim=c(20,250),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[2,],col="green")
legend( x="topleft",legend=c("EBS", "IBS"),
col=c("black", "green"), lty=c(1,1), cex=0.8)
dev.off()
pdf("zero_1_beta_1.pdf")
plot(sampl_size_log10,leng_ebs[3,],type="l",ylim=c(2,30),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[3,],col="green")
legend( x="topleft",legend=c("EBS", "IBS"),
col=c("black", "green"), lty=c(1,1), cex=0.8)
dev.off()
pdf("zero_2_beta_1.pdf")
plot(sampl_size_log10,leng_ebs[4,],type="l",ylim=c(2,25),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[4,],col="green")
legend( x="topleft",legend=c("EBS", "IBS"),
col=c("black", "green"), lty=c(1,1), cex=0.8)
dev.off()
pdf("zero_5_beta_1.pdf")
plot(sampl_size_log10,leng_ebs[5,],type="l",ylim=c(1,20),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[5,],col="green")
legend( x="topleft",legend=c("EBS", "IBS"),
col=c("black", "green"), lty=c(1,1), cex=0.8)
dev.off()
############################################################
#New setup for beta
sq_n <- seq(1e4,1e6,by=5e3)
leng_ebs <- matrix(nrow=5,ncol=length(sq_n))
leng_ibs <- matrix(nrow=5,ncol=length(sq_n))
for( k in 1:length(sq_n)){
n <- sq_n[k]
for (m in 1 : length(cns_sq)){
leng_ebs[m,k] <- ebs_lng(n,cns=cns_sq[m],alp,bet_typ=2)
leng_ibs[m,k] <- ibs_lng(n,cns=cns_sq[m],alp)
}
}
sampl_size_log10 <- log10(sq_n)
pdf("zero_pt_01_beta_2.pdf")
plot(sampl_size_log10,leng_ebs[1,],type="l",ylim=c(20,8000),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[1,],col="green")
legend( x="topleft",legend=c("EBS", "IBS"),
col=c("black", "green"), lty=c(1,1), cex=0.8)
dev.off()
pdf("zero_pt_1_beta_2.pdf")
plot(sampl_size_log10,leng_ebs[2,],type="l",ylim=c(20,900),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[2,],col="green")
legend( x="topleft",legend=c("EBS", "IBS"),
col=c("black", "green"), lty=c(1,1), cex=0.8)
dev.off()
pdf("zero_1_beta_2.pdf")
plot(sampl_size_log10,leng_ebs[3,],type="l",ylim=c(5,80),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[3,],col="green")
legend( x="topleft",legend=c("EBS", "IBS"),
col=c("black", "green"), lty=c(1,1), cex=0.8)
dev.off()
pdf("zero_2_beta_2.pdf")
plot(sampl_size_log10,leng_ebs[4,],type="l",ylim=c(2,40),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[4,],col="green")
legend( x="topleft",legend=c("EBS", "IBS"),
col=c("black", "green"), lty=c(1,1), cex=0.8)
dev.off()
pdf("zero_5_beta_2.pdf")
plot(sampl_size_log10,leng_ebs[5,],type="l",ylim=c(1,20),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[5,],col="green")
legend( x="topleft",legend=c("EBS", "IBS"),
col=c("black", "green"), lty=c(1,1), cex=0.8)
dev.off()
########################################################
sq_n <- seq(1e3,1e6,by=5e3)
leng_ebs <- matrix(nrow=5,ncol=length(sq_n))
leng_ibs <- matrix(nrow=5,ncol=length(sq_n))
for( k in 1:length(sq_n)){
n <- sq_n[k]
for (m in 1 : length(cns_sq)){
leng_ebs[m,k] <- ebs_lng(n,cns=cns_sq[m],alp,bet_typ=3)
leng_ibs[m,k] <- ibs_lng(n,cns=cns_sq[m],alp)
}
}
sampl_size_log10 <- log10(sq_n)
pdf("zero_pt_01_beta_3.pdf")
plot(sampl_size_log10,leng_ebs[1,],type="l",ylim=c(2,9000),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[1,],col="green")
legend( x="topleft",legend=c("EBS", "IBS"),
col=c("black", "green"), lty=c(1,1), cex=0.8)
dev.off()
pdf("zero_pt_1_beta_3.pdf")
plot(sampl_size_log10,leng_ebs[2,],type="l",ylim=c(20,950),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[2,],col="green")
legend( x="topleft",legend=c("EBS", "IBS"),
col=c("black", "green"), lty=c(1,1), cex=0.8)
dev.off()
pdf("zero_1_beta_3.pdf")
plot(sampl_size_log10,leng_ebs[3,],type="l",ylim=c(2,100),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[3,],col="green")
legend( x="topleft",legend=c("EBS", "IBS"),
col=c("black", "green"), lty=c(1,1), cex=0.8)
dev.off()
pdf("zero_2_beta_3.pdf")
plot(sampl_size_log10,leng_ebs[4,],type="l",ylim=c(2,50),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[4,],col="green")
legend( x="topleft",legend=c("EBS", "IBS"),
col=c("black", "green"), lty=c(1,1), cex=0.8)
dev.off()
pdf("zero_5_beta_3.pdf")
plot(sampl_size_log10,leng_ebs[5,],type="l",ylim=c(1,20),xlab="Sample Size ",ylab="Number of batches")
lines(sampl_size_log10,leng_ibs[5,],col="green")
legend( x="topleft",legend=c("EBS", "IBS"),
col=c("black", "green"), lty=c(1,1), cex=0.8)
dev.off()
